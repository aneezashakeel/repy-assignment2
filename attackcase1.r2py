# Test: Invalid B file should not be promoted to A on close
try:
  myfile = ABopenfile("testfile1.txt", True)
  myfile.writeat("SHOW", 0)  # Invalid - no 'E'
  myfile.close()
  
  # If we can read "SHOW" from A file, bug found
  myfile = ABopenfile("testfile1.txt", False)
  data = myfile.readat(None, 0)
  if data == "SHOW":
    log("BUG: Invalid B file was promoted to A!")
  myfile.close()
except:
  pass
